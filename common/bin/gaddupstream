#!/bin/bash

if ! command -v jq &> /dev/null
then
  while true; do
      read -r -p "jq not found. Install now? (Y/N): " answer
      case $answer in
          [Yy]* ) sudo apt install jq -y; break;;
          [Nn]* ) exit;;
          * ) echo "Please answer Y or N.";;
      esac
  done
fi

if ! command -v jq &> /dev/null
then
  echo "jq did not install correctly. Please try again."
  exit
fi

url=$(git remote get-url origin)
repoWithOwnerExt=${url#*github.com[/:]}
repoWithOwner=${repoWithOwnerExt%.git}
remote=$(curl -s "https://api.github.com/repos/$repoWithOwner" | jq -r '.parent.clone_url')
if [ "$remote" != "null" ]; then
  git remote add upstream $remote
  echo "added upstream: $remote"
else
  echo "no upstream found"
fi